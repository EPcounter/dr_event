<!DOCTYPE html>
<html>
<head>
  <title>DR Event Countdown</title>
  <meta charset="UTF-8">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>
  <style>
    body {
      margin: 0;
      padding: 8px;
      background: #121212; /* dark background */
      font-family: 'Open Sans', Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    /* Timeline styles */
.timeline-box {
  width: 100%;
  max-width: 1400px;
  text-align: center;
  margin-top: 24px;   /* Padding before */
  margin-bottom: 24px; /* Padding after */
}

    
.timeline-labels {
  position: relative;
  height: 20px;
  margin-bottom: 4px;
}

.timeline-labels span {
  position: absolute;
  font-size: 12px;
  transform: translateX(-50%);
  white-space: nowrap;
  color: #fff;
}
    .timeline-track {
      position: relative;
      height: 6px;
      background: #333;
      border-radius: 4px;
      margin: 0 8px;
    }
    #timeline-progress {
      position: absolute;
      height: 6px;
  background: rgba(243, 156, 18, 0.3); /* soft transparent orange */
      border-radius: 4px;
      width: 0%;
      transition: width 0.5s ease;
        z-index: 1;

    }
    .timeline-now-marker {
  position: absolute;
  top: -8px; /* Adjust vertically as needed */
  left: 0;
  font-size: 14px;
  color: #f39c12;
  transform: translateX(-50%);
  pointer-events: none;
  font-weight: bold;
  z-index: 10;
}


    /* Countdown widget styles */
    .widget-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 14px;
    }
    .countdown-box {
      background: #1f1f1f;
      border: 1px solid #333;
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      width: 200px;
      box-shadow: 0 0 6px rgba(0,0,0,0.3);
      color: #fff;
    }
    .title {
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 4px;
    }
    .time-label {
      font-size: 12px;
      color: #bbb;
      margin-bottom: 6px;
    }
    .status-text {
      font-size: 12px;
      margin-top: 6px;
      font-weight: bold;
      text-transform: uppercase;
    }
    .live-label {
      display: inline-block;
      margin-top: 4px;
      padding: 2px 6px;
      font-size: 10px;
      font-weight: bold;
      color: white;
      background-color: red;
      border-radius: 4px;
    }
    .timer {
      display: flex;
      justify-content: center;
      gap: 2px;
    }
    .digit {
      font-size: 18px;
      color: #fff;
      padding: 4px 6px;
      border-radius: 4px;
      min-width: 30px;
    }
    .digit.default {
      background: linear-gradient(to bottom, #444, #111);
    }
    .digit.active {
      background: linear-gradient(to bottom, #f5d76e, #f39c12);
    }
    .digit.seconds {
      background: linear-gradient(to bottom, #eee, #ccc) !important;
      color: #333 !important;
    }
    .separator {
      font-size: 18px;
      color: #ccc;
      padding: 0 1px;
    }
    .local-date, .next-refresh-time {
      font-size: 11px;
      color: #aaa;
    }

    .box-up-next {
      background: #2e2e1f !important;
      border: 1px solid #f4d03f !important;
    }
    .box-past {
      background: #2b2b2b !important;
      color: #777;
    }
    .box-past .title,
    .box-past .status-text,
    .box-past .time-label {
      color: #777 !important;
    }
    #current-box .status-text {
  font-size: 11px;
  color: #aaa;
  margin-top: 6px;
  font-weight: bold;
  text-transform: uppercase;
}
    .timeline-tick {
  position: absolute;
  top: 8px;
  transform: translateX(-50%);
  font-size: 10px;
  color: #ccc;
  white-space: nowrap;
}
    .status-upcoming {
  color: #f5d76e; /* yellow */
}
.status-live {
  color: #e74c3c; /* red */
}
.status-ended {
  color: #999; /* gray */
}
.blinker {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin-left: 6px;
  border-radius: 50%;
  background-color: #f5d76e;
  animation: blink 1s infinite;
  vertical-align: middle;
}

@keyframes blink {
  0%   { opacity: 1; }
  50%  { opacity: 0; }
  100% { opacity: 1; }
}

    .status-dot {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin-left: 6px;
  border-radius: 50%;
  vertical-align: middle;
}


.dot-ended {
  display: inline-block;
  font-size: 12px;
  margin-left: 6px;
  color: #bbb;
}

@keyframes blink {
  0%   { opacity: 1; }
  50%  { opacity: 0; }
  100% { opacity: 1; }
}
.dot-yellow {
  background-color: #f5d76e; /* yellow */
  animation: blink 1s infinite;
}

.dot-orange {
  background-color: orange;
  animation: blink 1s infinite;
}

.dot-red {
  background-color: #e74c3c;
  animation: blink 1s infinite;
}
    .dot-blue {
  background-color: #3498db; /* blue */
  animation: blink 1s infinite;
}
    #event-window-shade {
  position: absolute;
  height: 6px;
/* background-color: rgba(231, 76, 60, 0.3); */ /* soft red */
background-color: rgba(255, 50, 50, 0.6); /* brighter red with more opacity */
      top: 0;
  border-radius: 4px;
       animation: pulseEventWindow 2s infinite;
  box-shadow: 0 0 8px 3px rgba(255, 50, 50, 0.5); /* ðŸ”´ red glow */
}
   #standby-activation-shade {
  position: absolute;
  height: 6px;
   background-color: rgba(255, 223, 70, 0.25); /* light yellow */
  top: 0;
  border-radius: 4px;
  z-index: 3;
}
    #activation-event-shade {
  position: absolute;
  height: 6px;
 background-color: rgba(255, 140, 0, 0.25); /* soft orange */
  top: 0;
  border-radius: 4px;
  z-index: 2;
}
@keyframes pulseEventWindow {
  0% { opacity: 0.2; }
  50% { opacity: 1; }
  100% { opacity: 0.2; }
}

#event-window-shade {
  animation: pulseEventWindow 2s infinite;
}

#label-dayahead,
#label-intraday {
  font-size: 11px;
  color: #aaa;
}

#timeline-divider {
  position: absolute;
  top: -6px;
  bottom: -6px;
  width: 0;
  border-left: 2px dashed #888;
  z-index: 1;
}

.timeline-labels-top {
  position: relative;
  height: 30px;
  margin-bottom: 6px;
}

.timeline-labels-top span {
  font-size: 11px;
  color: #aaa;
  position: absolute;
  transform: translateX(-50%);
  white-space: nowrap;
}

    .timeline-labels .hover-zone {
  position: absolute;
  transform: translateX(-50%);
}

.timeline-labels .hover-zone span {
  visibility: hidden;
  opacity: 0;
    transition: opacity 0.3s ease, visibility 0.3s ease;

}

#standby-activation-shade:hover ~ .timeline-labels #zone-standby span,
#activation-event-shade:hover ~ .timeline-labels #zone-activation span,
#event-window-shade:hover ~ .timeline-labels #zone-event span {
  visibility: visible;
  opacity: 1;
}

    #dayahead-border,
#intraday-border {
  position: absolute;
  top: 0px; /* slightly above the timeline */
  height: 6px; /* covers timeline and ticks */
  width: 50%;
  border: 1px solid rgba(255, 255, 255, 0.2); /* subtle white border */
  border-radius: 6px;
  pointer-events: none; /* so they donâ€™t interfere with hovers */
  z-index: 0;
}

#dayahead-border {
  left: 0;
}

#intraday-border {
  left: 50%;
}
 @keyframes pulseOnHover {
  0%   { opacity: 0.3; }
  50%  { opacity: 1; }
  100% { opacity: 0.3; }
}
#standby-activation-shade:hover,
#activation-event-shade:hover {
  animation: pulseOnHover 1.5s infinite;
}

#standby-activation-shade:hover {
  animation: pulseOnHover 1.5s infinite;
  box-shadow: 0 0 8px 3px rgba(255, 223, 70, 0.5); /* yellow glow */
}

#activation-event-shade:hover {
  animation: pulseOnHover 1.5s infinite;
  box-shadow: 0 0 8px 3px rgba(255, 140, 0, 0.5); /* orange glow */
}
.label-box {
  position: absolute; /* ðŸ‘ˆ Important */
  display: inline-block;
  padding: 4px 10px;
  border: 1px solid transparent;
  border-radius: 6px;
  transition: all 0.3s ease;
  cursor: pointer;
  text-align: center;
  transform: translateX(-50%); /* Center over left% */
}


/* .label-box:hover {
  animation: pulseGlow 1.5s infinite;
  border-color: rgba(255, 255, 255, 0.4);
  box-shadow: 0 0 12px 6px rgba(255, 255, 255, 0.4);
  background-color: rgba(255, 255, 255, 0.05);
}
    .label-box:hover span {
  color: #fff;
}
   */ 

@keyframes pulseGlow {
  0%   { box-shadow: 0 0 6px 2px rgba(255, 255, 255, 0.2); }
  50%  { box-shadow: 0 0 14px 8px rgba(255, 255, 255, 0.5); }
  100% { box-shadow: 0 0 6px 2px rgba(255, 255, 255, 0.2); }
}

#dayahead-border,
#intraday-border {
  transition: box-shadow 0.3s ease;
}

.label-box#box-dayahead:hover ~ .timeline-track #dayahead-border,
.label-box#box-intraday:hover ~ .timeline-track #intraday-border {
  box-shadow: 0 0 12px 4px rgba(255, 255, 255, 0.4);
  border-color: rgba(255, 255, 255, 0.5);
}
@keyframes pulseTimelineGlow {
  0%   { box-shadow: 0 0 4px 2px rgba(255, 255, 255, 0.2); }
  50%  { box-shadow: 0 0 12px 6px rgba(255, 255, 255, 0.4); }
  100% { box-shadow: 0 0 4px 2px rgba(255, 255, 255, 0.2); }
}

.label-box#box-dayahead:hover ~ .timeline-track #dayahead-border,
.label-box#box-intraday:hover ~ .timeline-track #intraday-border {
  animation: pulseTimelineGlow 1.5s infinite;
  border-color: rgba(255, 255, 255, 0.6);
  z-index: 5;
}
#dayahead-border,
#intraday-border {
  transition: box-shadow 0.3s ease, border-color 0.3s ease;
  box-shadow: none;
}
@keyframes pulseTimelineGlow {
  0%   { box-shadow: 0 0 4px 2px rgba(255, 255, 255, 0.2); }
  50%  { box-shadow: 0 0 12px 6px rgba(255, 255, 255, 0.4); }
  100% { box-shadow: 0 0 4px 2px rgba(255, 255, 255, 0.2); }
}

.glow-pulse {
  animation: pulseTimelineGlow 1.5s infinite;
  border-color: rgba(255, 255, 255, 0.6);
  z-index: 5;
}

/*    .label-box:hover {
  animation: pulseGlow 1.5s infinite;
  border-color: rgba(255, 255, 255, 0.4);
  box-shadow: 0 0 12px 6px rgba(255, 255, 255, 0.4);
  background-color: rgba(255, 255, 255, 0.05);
}
  */  


    .so-marker-line {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 1px;
  border-left: 1px dashed #aaa;
  z-index: 4;
  pointer-events: none;
}

.so-marker-label {
  position: absolute;
  top: -20px;
  font-size: 10px;
  color: #aaa;
  transform: translateX(-50%);
  white-space: nowrap;
  z-index: 4;
}
  </style>
</head>
<body>


  <!-- Timeline -->
 <div class="timeline-box">
  
  <!-- First row: Day-Ahead and Intra-Day -->
  <div class="timeline-labels-top">
<div id="box-dayahead" class="label-box"><span id="label-dayahead">ðŸ“… Day-Ahead</span></div>
<div id="box-intraday" class="label-box"><span id="label-intraday">ðŸ•˜ Intra-Day</span></div>

  </div>

<!-- Second row: Standby, Activation, Event -->
<div class="timeline-labels">
  <div class="hover-zone" id="zone-standby">
    <span id="label-standby">ðŸ“£ Standby</span>
  </div>
  <div class="hover-zone" id="zone-activation">
    <span id="label-activation">ðŸ“£ Activation</span>
  </div>
  <div class="hover-zone" id="zone-event">
    <span id="label-event">âš¡Event</span>
  </div>
</div>


  <!-- Timeline track with shades, progress, ticks -->
  <div class="timeline-track">

    <div id="dayahead-border"></div>  
    <div id="intraday-border"></div>

    <div id="so-notify-line" class="so-marker-line"></div>

    
    <div id="standby-activation-shade"></div>
    <div id="activation-event-shade"></div>
    <div id="event-window-shade"></div>
    <div id="timeline-progress"></div>
    <div class="timeline-now-marker">â–¼</div>
    <div id="timeline-divider"></div>

    <!-- Tick markers -->
    <div class="timeline-tick"><span id="tick-time-start">--</span></div>
    <div class="timeline-tick"><span id="tick-time-standby">--</span></div>
    <div class="timeline-tick"><span id="tick-time-activation">--</span></div>
    <div class="timeline-tick"><span id="tick-time-event">--</span></div>
    <div class="timeline-tick"><span id="tick-time-end">--</span></div>
    <div class="timeline-tick"><span id="tick-time-finish">--</span></div>
  </div>

</div>



  

  <!-- Countdown widgets -->
  <div class="widget-row">
    <div class="countdown-box">
    <div class="title">ðŸ“Š Event Info</div>
    <div class="time-label">Event #: 13</div>
    <div class="status-text">Peak Demand - Standard 24hr Notice</div>
    <div class="status-text" id="event-status-tag">--</div>
  </div>


    
    <div class="countdown-box" id="standby-box">
      <div class="title">ðŸ“£ Standby Notice</div>
      <div class="time-label">August 3, 1:00 PM</div>
      <div id="standby-timer" class="timer"></div>
      <div id="standby-status" class="status-text"></div>
    </div>

    <div class="countdown-box" id="activation-box">
      <div class="title">ðŸ“£ Activation Notice</div>
      <div class="time-label">August 4, 9:00 AM</div>
      <div id="activation-timer" class="timer"></div>
      <div id="activation-status" class="status-text"></div>
    </div>

    <div class="countdown-box" id="event-box">
      <div class="title">âš¡ Activation Event</div>
      <div class="time-label">August 4, 1:00 PM â€“ 5:00 PM</div>
      <div id="event-timer" class="timer"></div>
      <div id="event-status" class="status-text"></div>
      <div id="live-label" class="live-label" style="display: none;">LIVE</div>
    </div>

    <div class="countdown-box" id="current-box">
        <div class="title">ðŸ•’ Current Time</div>
        <div class="time-label" id="local-date">Loading...</div>
        <div id="current-time" class="timer"></div>
        <div class="status-text" id="next-refresh-text">Next update at --:-- (--:--)</div>
  </div>
  </div>

  <!-- Script -->
  <script>
    const abuDhabiOffset = 4 * 60;

    function getAbuDhabiNow() {
      const now = new Date();
      const utc = now.getTime() + now.getTimezoneOffset() * 60000;
      return new Date(utc + abuDhabiOffset * 60000);
    }

    function getCountdownParts(diffMs) {
      const totalSeconds = Math.max(0, Math.floor(diffMs / 1000));
      const hours = Math.floor(totalSeconds / 3600);
      const minutes = Math.floor((totalSeconds % 3600) / 60);
      const seconds = totalSeconds % 60;
      return {
        h: hours.toString().padStart(2, '0'),
        m: minutes.toString().padStart(2, '0'),
        s: seconds.toString().padStart(2, '0')
      };
    }

    function renderTimer(containerId, parts, isActive) {
      const digitClass = isActive ? 'digit active' : 'digit default';
      document.getElementById(containerId).innerHTML = `
        <div class="${digitClass}">${parts.h}</div>
        <div class="separator">:</div>
        <div class="${digitClass}">${parts.m}</div>
        <div class="separator">:</div>
        <div class="digit seconds">${parts.s}</div>
      `;
    }

    function formatDate(date) {
      const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
      return date.toLocaleDateString('en-US', options);
    }

    function formatAMPM(date) {
      let hours = date.getHours();
      let minutes = date.getMinutes();
      const ampm = hours >= 12 ? 'p.m.' : 'a.m.';
      hours = hours % 12;
      hours = hours ? hours : 12;
      minutes = minutes < 10 ? '0' + minutes : minutes;
      return hours + ':' + minutes + ' ' + ampm;
    }

    function getNextRefreshTime(nowAbuDhabi) {
      const next = new Date(nowAbuDhabi);
      next.setMinutes(5);
      next.setSeconds(0);
      next.setMilliseconds(0);
      if (nowAbuDhabi.getMinutes() >= 5) {
        next.setHours(next.getHours() + 1);
      }
      return next;
    }

  function updateCountdowns() {
  const now = getAbuDhabiNow();

  const standbyTime = new Date("2025-08-03T13:00:00+04:00");
  const activationTime = new Date("2025-08-04T09:00:00+04:00");
  const eventStart = new Date("2025-08-04T13:00:00+04:00");
  const eventEnd = new Date("2025-08-04T17:00:00+04:00");

    
    
  // Define timeline window
  const timelineStart = new Date("2025-08-03T00:00:00+04:00");
  const timelineEnd = new Date("2025-08-04T23:59:59+04:00");
  const timelineDuration = timelineEnd - timelineStart;

// Split between Day-Ahead and Intra-Day
    const splitTime = new Date("2025-08-04T00:00:00+04:00");
const splitPercent = ((splitTime - timelineStart) / timelineDuration) * 100;

// Divider
const divider = document.getElementById("timeline-divider");
divider.style.left = `${splitPercent}%`;

// Labels


    
    

    const standbyStartPercent = ((standbyTime - timelineStart) / timelineDuration) * 100;
const activationStartPercent = ((activationTime - timelineStart) / timelineDuration) * 100;
const eventStartPercent = ((eventStart - timelineStart) / timelineDuration) * 100;
const eventEndPercent = ((eventEnd - timelineStart) / timelineDuration) * 100;

// Shaded area from standby to activation
const activationEndPercent = ((activationTime - timelineStart) / timelineDuration) * 100;
const standbyActivationShade = document.getElementById("standby-activation-shade");
standbyActivationShade.style.left = `${standbyStartPercent}%`;
standbyActivationShade.style.width = `${activationEndPercent - standbyStartPercent}%`;

// Center each label above its shaded area
document.getElementById("zone-standby").style.left = `${(standbyStartPercent + activationStartPercent) / 2 - 1}%`;
document.getElementById("zone-activation").style.left = `${(activationStartPercent + eventStartPercent) / 2 - 1}%`;
document.getElementById("zone-event").style.left = `${(eventStartPercent + eventEndPercent) / 2 - 1}%`;

document.getElementById("box-dayahead").style.left = `${splitPercent / 2 - 1}%`;
document.getElementById("box-intraday").style.left = `${(splitPercent + (100 - splitPercent) / 2 + 1)}%`;


    
      // Event window shading
      
      const shade = document.getElementById("event-window-shade");
      shade.style.left = `${eventStartPercent}%`;
      shade.style.width = `${eventEndPercent - eventStartPercent}%`;

      // Activation â†’ Event shaded area
      const eventStartPercentForShade = ((eventStart - timelineStart) / timelineDuration) * 100;
      const activationEventShade = document.getElementById("activation-event-shade");
      activationEventShade.style.left = `${activationStartPercent}%`;
      activationEventShade.style.width = `${eventStartPercentForShade - activationStartPercent}%`;
    
  // Helper: timeline % position
  function percentOfTimeline(time) {
    return ((time - timelineStart) / timelineDuration) * 100;
  }

  // Tick labels
  document.getElementById("tick-time-start").textContent = timelineStart.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true });

    document.getElementById("tick-time-standby").textContent = standbyTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true });
  document.getElementById("tick-time-activation").textContent = activationTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true });
  document.getElementById("tick-time-event").textContent = eventStart.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true });
  document.getElementById("tick-time-end").textContent = eventEnd.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true });
document.getElementById("tick-time-finish").textContent = timelineEnd.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true });

  // Tick positions
// Position each tick along the timeline
    const ticks = document.querySelectorAll(".timeline-tick");
ticks[0].style.left = `0%`; // Start of timeline
ticks[1].style.left = `${percentOfTimeline(standbyTime)}%`;
ticks[2].style.left = `${percentOfTimeline(activationTime)}%`;
ticks[3].style.left = `${percentOfTimeline(eventStart)}%`;
ticks[4].style.left = `${percentOfTimeline(eventEnd)}%`;
ticks[5].style.left = `100%`; // End of timeline

// === Dynamically add SO Notify marker(s) ===
const soMarkerTimes = [];
const currentDay = new Date(timelineStart);
while (currentDay <= timelineEnd) {
const notifyTime = new Date(currentDay.getTime());
  notifyTime.setHours(10, 0, 0, 0); // Set time to 10:00 AM
  if (notifyTime >= timelineStart && notifyTime <= timelineEnd) {
    soMarkerTimes.push(new Date(notifyTime));
  }
  currentDay.setDate(currentDay.getDate() + 1);
}

// Append markers to the timeline track
soMarkerTimes.forEach((notifyTime, index) => {
  const percent = percentOfTimeline(notifyTime);

  // Line
  const line = document.createElement("div");
  line.className = "so-marker-line";
  line.style.left = `${percent}%`;

  // Label
  const label = document.createElement("div");
  label.className = "so-marker-label";
  label.style.left = `${percent}%`;
  label.textContent = "ðŸ“© 10 AM - EWEC";

  // Append
  document.querySelector(".timeline-track").appendChild(line);
  document.querySelector(".timeline-track").appendChild(label);
});

  // Find next upcoming
  const times = [
    { id: 'standby', time: standbyTime },
    { id: 'activation', time: activationTime },
    { id: 'event', time: eventStart }
  ];
  const futureEvents = times.filter(t => now < t.time).sort((a, b) => a.time - b.time);
  const nextUpcomingId = futureEvents.length ? futureEvents[0].id : null;

  // Clear classes
  ['standby', 'activation', 'event'].forEach(id => {
    const box = document.getElementById(`${id}-box`);
    box.classList.remove('box-up-next', 'box-past');
  });

  // Standby
  const sbBox = document.getElementById("standby-box");
  renderTimer("standby-timer", getCountdownParts(standbyTime - now), nextUpcomingId === 'standby');
  document.getElementById("standby-status").textContent = now >= standbyTime ? "PAST" : "Starting in";
  if (now >= standbyTime) sbBox.classList.add("box-past");
  if (nextUpcomingId === 'standby') sbBox.classList.add("box-up-next");

  // Activation
  const actBox = document.getElementById("activation-box");
  renderTimer("activation-timer", getCountdownParts(activationTime - now), nextUpcomingId === 'activation');
  document.getElementById("activation-status").textContent = now >= activationTime ? "PAST" : "Starting in";
  if (now >= activationTime) actBox.classList.add("box-past");
  if (nextUpcomingId === 'activation') actBox.classList.add("box-up-next");

  // Event
  const evBox = document.getElementById("event-box");
  const liveLabel = document.getElementById("live-label");
  let eventParts, eventStatus;
  if (now < eventStart) {
    eventParts = getCountdownParts(eventStart - now);
    eventStatus = "Starting in";
    liveLabel.style.display = "none";
  } else if (now >= eventStart && now < eventEnd) {
    eventParts = getCountdownParts(eventEnd - now);
    eventStatus = "Ending in";
    liveLabel.style.display = "inline-block";
  } else {
    eventParts = getCountdownParts(0);
    eventStatus = "ENDED";
    liveLabel.style.display = "none";
  }
  renderTimer("event-timer", eventParts, nextUpcomingId === 'event');
  document.getElementById("event-status").textContent = eventStatus;
  if (now >= eventEnd) evBox.classList.add("box-past");
  if (nextUpcomingId === 'event') evBox.classList.add("box-up-next");

  // Current time
  const h = now.getHours().toString().padStart(2, '0');
  const m = now.getMinutes().toString().padStart(2, '0');
  const s = now.getSeconds().toString().padStart(2, '0');
  document.getElementById('local-date').textContent = formatDate(now);
  renderTimer("current-time", { h, m, s }, false);

  // Refresh info
  const nextRefresh = getNextRefreshTime(now);
  const cd = getCountdownParts(nextRefresh - now);
  document.getElementById("next-refresh-text").textContent = `Next update at ${formatAMPM(nextRefresh)} (${cd.h}:${cd.m}:${cd.s})`;

// Progress bar: starts from standbyTime, fills as time progresses, sized on full timeline
const progressStart = Math.max(0, standbyTime - timelineStart);
const progressNow = Math.min(now, timelineEnd);
const progressElapsed = Math.max(0, progressNow - standbyTime);

const progressLeftPercent = (progressStart / timelineDuration) * 100;
const progressWidthPercent = (progressElapsed / timelineDuration) * 100;

const progressBar = document.getElementById("timeline-progress");
progressBar.style.left = `${progressLeftPercent}%`;
progressBar.style.width = `${progressWidthPercent}%`;

  // Marker follows full timeline
  const absoluteNowPercent = Math.min(100, Math.max(0, ((now - timelineStart) / timelineDuration) * 100));
  const marker = document.querySelector(".timeline-now-marker");
if (now >= timelineStart && now <= timelineEnd) {
  marker.style.display = "block";
  marker.style.left = `${absoluteNowPercent}%`;
  marker.textContent = "â–¼";
} else {
  marker.style.display = "none";
}


  // Status symbol logic
  const statusTag = document.getElementById("event-status-tag");
  if (now < standbyTime) {
    statusTag.innerHTML = `ðŸ”¸ Planned <span class="status-dot dot-blue"></span>`;
    statusTag.className = "status-text status-upcoming";
  } else if (now >= standbyTime && now < activationTime) {
    statusTag.innerHTML = `â³ Upcoming <span class="status-dot dot-yellow"></span>`;
    statusTag.className = "status-text status-upcoming";
  } else if (now >= activationTime && now < eventStart) {
    statusTag.innerHTML = `ðŸŸ  Preparing <span class="status-dot dot-orange"></span>`;
    statusTag.className = "status-text status-upcoming";
  } else if (now >= eventStart && now < eventEnd) {
    statusTag.innerHTML = `ðŸ”´ In Progress <span class="status-dot dot-red"></span>`;
    statusTag.className = "status-text status-live";
  } else {
    statusTag.innerHTML = `âœ… Ended`;
    statusTag.className = "status-text status-ended";
  }

  // Label colors
  document.getElementById("label-standby").style.color = now > standbyTime ? "#777" : "#fff";
  document.getElementById("label-activation").style.color = now > activationTime ? "#777" : "#fff";
  document.getElementById("label-event").style.color = now > eventStart ? (now < eventEnd ? "red" : "#777") : "#fff";
}

    function setupLabelHover(shadeId, zoneId) {
  const shade = document.getElementById(shadeId);
  const zone = document.getElementById(zoneId);
  const label = zone.querySelector("span");

  shade.addEventListener("mouseenter", () => {
    label.style.visibility = "visible";
    label.style.opacity = "1";
  });

  shade.addEventListener("mouseleave", () => {
    label.style.visibility = "hidden";
    label.style.opacity = "0";
  });
}

// Apply hover behavior for all shaded regions
setupLabelHover("standby-activation-shade", "zone-standby");
setupLabelHover("activation-event-shade", "zone-activation");
setupLabelHover("event-window-shade", "zone-event");

    // Add hover effects to Day-Ahead and Intra-Day labels for border pulse/glow
function setupBorderGlow(labelId, borderId) {
  const label = document.getElementById(labelId);
  const border = document.getElementById(borderId);

  label.addEventListener("mouseenter", () => {
    border.classList.add("glow-pulse");
  });

  label.addEventListener("mouseleave", () => {
    border.classList.remove("glow-pulse");
  });
}

setupBorderGlow("box-dayahead", "dayahead-border");
setupBorderGlow("box-intraday", "intraday-border");

    setInterval(updateCountdowns, 1000);
    updateCountdowns();
  </script>
</body>
</html>

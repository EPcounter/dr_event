<!DOCTYPE html>
<html>
<head>
  <title>DR Event Countdown</title>
  <meta charset="UTF-8">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>
  <style>
  body {
    margin: 0;
    padding: 5px;
    background: transparent;
    font-family: 'Open Sans', Arial, sans-serif;
    display: flex;
    justify-content: center;
    gap: 8px;
    flex-wrap: wrap;
  }
  .countdown-box {
    background: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px;
    text-align: center;
    width: 140px;
    box-shadow: 0 0 3px rgba(0,0,0,0.08);
  }
  .title {
    font-size: 12px;
    font-weight: bold;
    margin-bottom: 3px;
  }
  .time-label {
    font-size: 11px;
    color: #555;
    margin-bottom: 4px;
  }
  .status-text {
    font-size: 11px;
    margin-top: 4px;
    font-weight: bold;
    text-transform: uppercase;
  }
  .timer {
    display: flex;
    justify-content: center;
    gap: 1px;
  }
  .digit {
    font-size: 14px;
    color: #fff;
    padding: 2px 5px;
    border-radius: 3px;
    min-width: 22px;
  }
  .digit.default {
    background: linear-gradient(to bottom, #444, #111);
  }
  .digit.active {
    background: linear-gradient(to bottom, #f5d76e, #f39c12);
  }
  .digit.seconds {
    background: linear-gradient(to bottom, #eee, #ccc) !important;
    color: #333 !important;
  }
  .separator {
    font-size: 14px;
    color: #ccc;
    padding: 0 0.5px;
  }
  .local-date, .next-refresh-time {
    font-size: 10px;
    color: #999;
  }
</style>

</head>
<body>

  <div class="countdown-box">
    <div class="title">ðŸ“£ Standby Notice</div>
    <div class="time-label">June 29, 6:00 PM</div>
    <div id="standby-timer" class="timer"></div>
    <div id="standby-status" class="status-text"></div>
  </div>

  <div class="countdown-box">
    <div class="title">âš¡ Activation Notice</div>
    <div class="time-label">June 30, 9:00 AM</div>
    <div id="activation-timer" class="timer"></div>
    <div id="activation-status" class="status-text"></div>
  </div>

  <div class="countdown-box">
    <div class="title">ðŸ”¥ Activation Event</div>
    <div class="time-label">June 30, 6:00 PM â€“ 10:00 PM</div>
    <div id="event-timer" class="timer"></div>
    <div id="event-status" class="status-text"></div>
  </div>

  <div class="countdown-box">
    <div class="title">ðŸ•’ Current Time</div>
    <div class="local-date" id="local-date">Loading...</div>
    <div id="current-time" class="timer"></div>
    <div class="next-refresh-time" id="next-refresh-text">Next update at --:-- (--:--)</div>
  </div>

  <script>
    const abuDhabiOffset = 4 * 60;

    function getAbuDhabiNow() {
      const now = new Date();
      const utc = now.getTime() + now.getTimezoneOffset() * 60000;
      return new Date(utc + abuDhabiOffset * 60000);
    }

    function getCountdownParts(diffMs) {
      const totalSeconds = Math.max(0, Math.floor(diffMs / 1000));
      const hours = Math.floor(totalSeconds / 3600);
      const minutes = Math.floor((totalSeconds % 3600) / 60);
      const seconds = totalSeconds % 60;
      return {
        h: hours.toString().padStart(2, '0'),
        m: minutes.toString().padStart(2, '0'),
        s: seconds.toString().padStart(2, '0')
      };
    }

    function renderTimer(containerId, parts, isActive) {
      const digitClass = isActive ? 'digit active' : 'digit default';
      document.getElementById(containerId).innerHTML = `
        <div class="${digitClass}">${parts.h}</div>
        <div class="separator">:</div>
        <div class="${digitClass}">${parts.m}</div>
        <div class="separator">:</div>
        <div class="digit seconds">${parts.s}</div>
      `;
    }

    function formatDate(date) {
      const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
      return date.toLocaleDateString('en-US', options);
    }

    function formatAMPM(date) {
      let hours = date.getHours();
      let minutes = date.getMinutes();
      const ampm = hours >= 12 ? 'p.m.' : 'a.m.';
      hours = hours % 12;
      hours = hours ? hours : 12;
      minutes = minutes < 10 ? '0' + minutes : minutes;
      return hours + ':' + minutes + ' ' + ampm;
    }

    function getNextRefreshTime(nowAbuDhabi) {
      const next = new Date(nowAbuDhabi);
      next.setMinutes(5);
      next.setSeconds(0);
      next.setMilliseconds(0);
      if (nowAbuDhabi.getMinutes() >= 5) {
        next.setHours(next.getHours() + 1);
      }
      return next;
    }

    function updateCountdowns() {
      const now = getAbuDhabiNow();

      const standbyTime = new Date("2025-06-29T18:00:00+04:00");
      const activationTime = new Date("2025-06-30T09:00:00+04:00");
      const eventStart = new Date("2025-06-30T18:00:00+04:00");
      const eventEnd = new Date("2025-06-30T22:00:00+04:00");

      const times = [
        { id: 'standby', time: standbyTime, past: now >= standbyTime },
        { id: 'activation', time: activationTime, past: now >= activationTime },
        { id: 'event', time: eventStart, past: now >= eventEnd }
      ];

      const futureEvents = times.filter(t => now < t.time).sort((a, b) => a.time - b.time);
      const nextUpcomingId = futureEvents.length ? futureEvents[0].id : null;

      const sbParts = getCountdownParts(standbyTime - now);
      renderTimer("standby-timer", sbParts, nextUpcomingId === 'standby');
      document.getElementById("standby-status").textContent = now >= standbyTime ? "PAST" : "Starting in";

      const actParts = getCountdownParts(activationTime - now);
      renderTimer("activation-timer", actParts, nextUpcomingId === 'activation');
      document.getElementById("activation-status").textContent = now >= activationTime ? "PAST" : "Starting in";

      let eventStatus = "";
      let eventParts;
      if (now < eventStart) {
        eventParts = getCountdownParts(eventStart - now);
        eventStatus = "Starting in";
      } else if (now >= eventStart && now < eventEnd) {
        eventParts = getCountdownParts(eventEnd - now);
        eventStatus = "Ending in";
      } else {
        eventParts = getCountdownParts(0);
        eventStatus = "ENDED";
      }
      renderTimer("event-timer", eventParts, nextUpcomingId === 'event');
      document.getElementById("event-status").textContent = eventStatus;

      // Current time
      const h = now.getHours().toString().padStart(2, '0');
      const m = now.getMinutes().toString().padStart(2, '0');
      const s = now.getSeconds().toString().padStart(2, '0');
      document.getElementById('local-date').textContent = formatDate(now);
      renderTimer("current-time", { h, m, s }, false);

      // Refresh info
      const nextRefresh = getNextRefreshTime(now);
      const diff = nextRefresh - now;
      const cd = getCountdownParts(diff);
      document.getElementById("next-refresh-text").textContent = `Next update at ${formatAMPM(nextRefresh)} (${cd.h}:${cd.m}:${cd.s})`;
    }

    setInterval(updateCountdowns, 1000);
    updateCountdowns();
  </script>
</body>
</html>
